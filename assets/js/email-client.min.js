document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("form[data-worker-form='true']").forEach(e=>{const o=e.querySelector(".success-box"),s=e.querySelector(".error-box"),t=e.querySelector(".cf-loader");o&&o.classList.remove("show"),s&&s.classList.remove("show"),t&&t.classList.remove("show"),e.addEventListener("submit",async function(r){r.preventDefault();const a=e.querySelector("button[type='submit']");o&&o.classList.remove("show"),s&&s.classList.remove("show"),t&&t.classList.add("show"),a&&(a.disabled=!0);const l=new FormData(e),n={name:(l.get("Nombre *")||"")+" "+(l.get("Apellido *")||""),email:l.get("Correo *")||"",phone:l.get("Teléfono *")||"",message:l.get("Mensaje *")||"",otherDetails:{}};l.forEach((e,o)=>{["Nombre *","Apellido *","Correo *","Teléfono *","Mensaje *","_subject"].includes(o)||(n.otherDetails[o]=e)});try{const t=await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});t.ok?o?(o.classList.add("show"),e.reset()):alert("Mensaje enviado con éxito!"):(console.error("Server Error:",await t.text()),s?s.classList.add("show"):alert("Error al enviar el mensaje."))}catch(e){console.error("Network Error:",e),s&&s.classList.add("show")}finally{t&&t.classList.remove("show"),a&&(a.disabled=!1)}})})});