document.addEventListener("DOMContentLoaded",function(){const n=document.createElement("style");n.innerHTML="\n        #search-modal {\n            display: none;\n            position: fixed;\n            z-index: 10000;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n            background-color: rgba(0,0,0,0.85); /* Darker overlay */\n            backdrop-filter: blur(8px);\n            animation: fadeIn 0.3s ease;\n        }\n        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }\n\n        #search-modal-content {\n            background-color: #fff;\n            margin: 5vh auto;\n            max-width: 800px; /* Wider for premium feel */\n            width: 90%;\n            height: 80vh;\n            border-radius: 12px;\n            box-shadow: 0 10px 25px rgba(0,0,0,0.2);\n            display: flex;\n            flex-direction: column;\n            overflow: hidden;\n            position: relative;\n        }\n\n        .search-header {\n            padding: 20px;\n            border-bottom: 1px solid #eee;\n            display: flex;\n            align-items: center;\n            gap: 15px;\n        }\n\n        .close-search {\n            color: #888;\n            font-size: 28px;\n            font-weight: 300;\n            cursor: pointer;\n            transition: color 0.2s;\n            line-height: 1;\n        }\n        .close-search:hover { color: #000; }\n\n        #search-input {\n            flex-grow: 1;\n            padding: 12px 15px;\n            font-size: 20px;\n            border: none;\n            outline: none;\n            font-weight: 500;\n            color: #333;\n        }\n        #search-input::placeholder { color: #aaa; }\n\n        #search-results-container {\n            flex-grow: 1;\n            overflow-y: auto;\n            padding: 20px;\n            background-color: #f9f9f9;\n        }\n\n        /* CARD STYLE RESULTS */\n        .search-result-card {\n            background: #fff;\n            border-radius: 8px;\n            padding: 15px;\n            margin-bottom: 15px;\n            display: flex;\n            gap: 15px;\n            box-shadow: 0 2px 5px rgba(0,0,0,0.05);\n            transition: transform 0.2s, box-shadow 0.2s;\n            cursor: pointer;\n            text-decoration: none;\n            color: inherit;\n        }\n        .search-result-card:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 5px 15px rgba(0,0,0,0.1);\n        }\n        \n        .result-thumb {\n            width: 80px;\n            height: 80px;\n            border-radius: 6px;\n            object-fit: cover;\n            background-color: #eee;\n            flex-shrink: 0;\n        }\n\n        .result-content {\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n        }\n\n        .result-category {\n            font-size: 11px;\n            text-transform: uppercase;\n            letter-spacing: 1px;\n            color: #888;\n            font-weight: 600;\n            margin-bottom: 4px;\n        }\n\n        .result-title {\n            font-size: 16px;\n            font-weight: 700;\n            color: #222;\n            margin: 0 0 5px 0;\n        }\n\n        .result-desc {\n            font-size: 13px;\n            color: #666;\n            line-height: 1.4;\n            display: -webkit-box;\n            -webkit-line-clamp: 2;\n            -webkit-box-orient: vertical;\n            overflow: hidden;\n        }\n        \n        .result-match-reason {\n            font-size: 11px;\n            color: #2ecc71;\n            margin-top: 5px;\n            font-style: italic;\n        }\n\n        .no-results {\n            text-align: center;\n            padding: 40px;\n            color: #666;\n        }\n    ",document.head.appendChild(n),document.body.insertAdjacentHTML("beforeend",'\n        <div id="search-modal">\n            <div id="search-modal-content">\n                <div class="search-header">\n                    <i class="fa fa-search" style="font-size: 20px; color: #888;"></i>\n                    <input type="text" id="search-input" placeholder="Buscar proyectos, cocinas, servicios..." autocomplete="off">\n                    <span class="close-search">&times;</span>\n                </div>\n                <div id="search-results-container">\n                    <div class="no-results">Empieza a escribir para buscar...</div>\n                </div>\n            </div>\n        </div>\n    ');const e=document.getElementById("search-modal"),t=document.getElementById("search-input"),o=document.getElementById("search-results-container"),r=document.querySelector(".close-search");let a=null,s=null;document.querySelectorAll('#searchx a, a[href*="/portafolio"] .fa-search, .search-trigger').forEach(n=>{n.addEventListener("click",function(n){n.preventDefault(),e.style.display="block",t.focus(),async function(){if(!a)try{const n=await fetch("/assets/js/search-index.json");s=await n.json(),a=new Fuse(s,{includeScore:!0,includeMatches:!0,useExtendedSearch:!0,tokenize:!0,matchAllTokens:!0,keys:[{name:"title",weight:.7},{name:"keywords",weight:.6},{name:"category",weight:.4},{name:"description",weight:.3},{name:"body",weight:.1}],threshold:.2,ignoreLocation:!0,minMatchCharLength:3}),console.log("Smart Search index loaded (Fuse.js)")}catch(n){console.error("Failed to load search index",n),o.innerHTML='<div class="no-results">Error cargando el buscador.</div>'}}()})}),r.onclick=()=>e.style.display="none",window.onclick=n=>{n.target==e&&(e.style.display="none")},document.addEventListener("keydown",n=>{"Escape"===n.key&&"block"===e.style.display&&(e.style.display="none")});let i=null;t.addEventListener("input",function(){clearTimeout(i),i=setTimeout(()=>{const n=this.value;if(!a)return;if(n.length<2)return void(o.innerHTML='<div class="no-results">Escribe un poco m√°s...</div>');const e=a.search(n);if(0===e.length)return void(o.innerHTML='<div class="no-results">No se encontraron resultados para "'+n+'".<br><small>Intenta con otras palabras.</small></div>');let t="";e.slice(0,20).forEach(n=>{const e=n.item;t+=`\n                    <a href="${e.id}" class="search-result-card">\n                        <img src="${e.image}" class="result-thumb" loading="lazy" alt="${e.title}" onerror="this.src='/assets/storage/2016/12/169471652699961817.webp'">\n                        <div class="result-content">\n                            <span class="result-category">${e.category}</span>\n                            <h4 class="result-title">${e.title}</h4>\n                            <p class="result-desc">${e.description}</p>\n                        </div>\n                    </a>\n                `}),o.innerHTML=t},300)})});